首先将mysql的QimaoScraper数据库Seven_Cats_Novel_Data 导入到hive中，创建hive数据库hive_QimaoScraper，并创建hive原数据表
ods层：hive原数据表，数据来自于mysql的Seven_Cats_Novel_Data数据表
dwd层：hive原数据表，数据来自于hive的ods层数据表，对数据进行空列删除，缺值处理
ads层：hive原数据表，数据来自于hive的dwd层数据表，对数据进行特征工程，生成特征表，做数据可视化的元数据表
然后将ads层的特征表导入到mysql中，创建mysql数据库QimaoScraper_Feature_Data，并将ads层的表通过sqoop导入到mysql中
最后，通过mysql的QimaoScraper_Feature_Data数据库，进行数据可视化，包括数据探索、数据分析、数据可视化等

翻拍潜力分 = 0.3×热度稳定性（方差倒数） + 
            0.25×题材匹配度（影视公司偏好标签） +
            0.2×读者粘性（完读率，需估算） +
            0.15×作者等级（大神/白金/新人） +
            0.1×社会话题性（书名关键词在微博的提及量）

可视化：雷达图展示候选作品各维度得分，横轴对比多部作品

ods层数据表，导入mysql的数据表，数据表命名为：
   ods_novel_data   原数据 不做清理

ods->dwd层 数据处理:
    如果有一整列数据缺失，则删除该列
    如果有一整行数据缺失，则删除该行
    如果有一部分数据缺失，则用平均值填充缺失值
    如果有一部分数据异常，则用中位数或众数填充异常值
    dwd层数据表，导入hive的数据表，数据表命名为：
        dwd_novel_data   清理后的数据

dwd->ads层 数据处理:
    特征工程，生成特征表，做数据可视化的元数据表
    ads层的数据表的创建，需要根据执行方案中的方向，分为四个分类：
    ads_platform:  平台侧
    ads_auther:    作者侧
    ads_user:      用户侧
    ads_capital:   资本侧
    四个分类下，又要根据执行方案生成对应数据表：
    四个分类下的数据表：
        平台侧：
            ads_platform_heat           热度分析
                *   **分析逻辑**：计算同一 `book_id` 在不同 `rank_date` 的热度差值（一阶导数）和差值的变化率（二阶导数）。
                *   **涉及字段**：`book_id`, `numeric_popularity` (清洗后), `rank_date`, `category1_name`。
                *   **SQL 场景**：
                *   **环比增速**：查询昨日与今日热度差值超过阈值的作品。
                *   **冷启动监测**：筛选 `created_at` 在7天内，且 `numeric_popularity` 增长斜率高于同类平均值的作品。
            ads_platform_ranking_trend  榜单趋势分析
                *   **分析逻辑**：分析 `rank_name`（如“推荐榜”）与 `read_count` 增长的相关性。如果某本书上了榜但阅读量未随之增长，说明“德不配位”，应降权。
                *   **优化动作**：动态调整推荐位权重，将流量向**高转化率**（高评分 `score` + 高留存）作品倾斜。
          作者侧：
            ads_auther_reason             分析热度原因
                *   **分析逻辑**：将 `intro`（简介）和 `title` 进行分词处理（需结合外部NLP工具或MySQL全文检索），与 `numeric_popularity` 做回归分析。
                *   **涉及字段**：`category2_name`（细分题材）, `intro`, `words_num`, `status`。
                *   **洞察输出**：
                    *   *“在‘都市’分类下，简介包含‘系统’、‘逆袭’关键词的作品，平均初始热度高出30%。”*
                    *   *“字数在 50-80万字 区间且状态为 `连载中` 的作品，热度爬升最快。”*
            ads_auther_attenuation_effect          分析热度衰减效应
                #### **2. 断更/完结热度衰减模型**
                *   **分析逻辑**：监控 `status` 变为“已完结”后，`numeric_popularity` 的衰减曲线。
                *   **涉及字段**：`status`, `updated_at`, `rank_date`。
                *   **策略建议**：计算最佳“完结时长”，建议作者在热度衰减至 20% 前推出新书，利用老书余热导流。
          用户侧：
            ads_user_layered_recommendation                 分层推荐
                #### **1. 小众热度挖掘（圈层爆款）**
                *   **分析逻辑**：不看全局热度，看**分类内相对热度**。
                *   **涉及字段**：`category1_name`, `gender_type`, `score`。
                *   **SQL 场景**：
                    *   在 `gender_type = 'male'` 且 `category1_name = '科幻'` 的小圈子里，寻找 `score > 9.0` 且 `numeric_popularity` 排名 Top 5 的书，即使它们在全站总榜上排不到前100。
            ads_user_avoid_pitfalls                         避坑指南
                #### **2. 避坑指南（高热低分预警）**
                *   **分析逻辑**：识别“刷榜”或“黑红”特征。
                *   **指标计算**：计算 `numeric_popularity` 与 `score` 的比率。如果热度极高但评分极低（<6.0），则在推荐算法中降权。
          资本侧：
            ads_capital_ltv                                     IP 长尾价值计算（LTV）
                #### **1. IP 长尾价值计算（LTV）**
                *   **分析逻辑**：热度积分（Heat Integral）。计算一本书在时间轴上 `numeric_popularity` 的累积面积，而不仅仅是峰值。
                *   **涉及字段**：`rank_date`, `numeric_popularity`, `date_month`。
                *   **决策支持**：
                    *   **短线IP**：爆发快，衰减快（适合短剧改编）。
                    *   **长线IP**：热度平稳上升，持续时间长，累积积分高（适合出版、动漫实体化）。
            ads_capital_future_purchasing_power                粉丝粘性与购买力验证
                #### **2. 粉丝粘性与购买力验证**
                *   **分析逻辑**：利用 `number`（榜单排名数值）和 `read_count` 的比对。
                *   **涉及字段**：`unit`（单位）, `read_count`。
                *   **假设**：如果 `read_count`（阅读人数）相对较低，但 `rank_name`（如打赏榜/月票榜）很高，说明核心粉丝付费能力极强（ARPU高），是优质资本标的。
                
通过sqoop将ads数据表导入mysql中的QimaoScraper_Feature_Data数据库中，数据表结构用hive中的数据表结构转mysql的表结构。

hive的数据库结构如下示例：
    hive_QimaoScraper
        ods_novel_data                   原数据
        dwd_novel_data                   清理后的数据 
        ads_platform_heat                ads热度分析
        ads_platform_ranking_trend       ads榜单趋势分析

导出mysql后的数据库结构如下示例：
    QimaoScraper_Feature_Data
        ads_platform_heat                ads热度分析        
        ads_platform_ranking_trend       ads榜单趋势分析