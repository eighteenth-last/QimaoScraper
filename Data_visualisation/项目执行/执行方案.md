原表中最核心的问题在于：**热度相关字段（`popularity`, `read_count`）是字符串类型（`varchar`），且带有单位（如“万”、“亿”），这直接阻碍了数学运算和排序。**

因此，新的设计方案必须包含**数据清洗/标准化**层，并基于此构建**热度生命周期模型**。

以下是基于 **MySQL 表结构** 深度定制的**热度驱动型数据分析方案**：

---

### **核心前置工作：构建“标准化热度指数”**

在进行四侧分析前，必须解决数据类型问题。
*   **问题**：`popularity` 和 `read_count` 是 `varchar`，无法直接用于 `ORDER BY` 或数学计算。
*   **解决方案**：在逻辑层或生成列（Generated Column）中构建 **`Heat_Index` (热度指数)**。

**SQL 逻辑示例（虚拟列思路）：**
```sql
-- 将字符串转换为数值的逻辑（去除'万'乘10000）
ALTER TABLE Seven_Cats_Novel_Data
ADD COLUMN numeric_popularity DECIMAL(15,2) GENERATED ALWAYS AS (
    CASE 
        WHEN popularity LIKE '%亿%' THEN REPLACE(popularity, '亿', '') * 100000000
        WHEN popularity LIKE '%万%' THEN REPLACE(popularity, '万', '') * 10000
        ELSE popularity 
    END
) STORED,
ADD INDEX idx_numeric_pop (numeric_popularity);
```

---

### **一、平台侧：基于“热度加速度”的流量分发系统**

**核心目标**：识别处于“热度爆发期”的作品，而非仅仅是“当前最热”的作品，实现流量效益最大化。

#### **1. 热度飙升算法（Traffic Boosting）**
*   **分析逻辑**：计算同一 `book_id` 在不同 `rank_date` 的热度差值（一阶导数）和差值的变化率（二阶导数）。
*   **涉及字段**：`book_id`, `numeric_popularity` (清洗后), `rank_date`, `category1_name`。
*   **SQL 场景**：
    *   **环比增速**：查询昨日与今日热度差值超过阈值的作品。
    *   **冷启动监测**：筛选 `created_at` 在7天内，且 `numeric_popularity` 增长斜率高于同类平均值的作品。

#### **2. 榜单马太效应分析**
*   **分析逻辑**：分析 `rank_name`（如“推荐榜”）与 `read_count` 增长的相关性。如果某本书上了榜但阅读量未随之增长，说明“德不配位”，应降权。
*   **优化动作**：动态调整推荐位权重，将流量向**高转化率**（高评分 `score` + 高留存）作品倾斜。

---

### **二、作者侧：基于“热度归因”的创作罗盘**

**核心目标**：告诉作者“为什么这类书热度高”，而不仅仅是“这类书热度高”。

#### **1. 黄金元素提取（热度与标签相关性）**
*   **分析逻辑**：将 `intro`（简介）和 `title` 进行分词处理（需结合外部NLP工具或MySQL全文检索），与 `numeric_popularity` 做回归分析。
*   **涉及字段**：`category2_name`（细分题材）, `intro`, `words_num`, `status`。
*   **洞察输出**：
    *   *“在‘都市’分类下，简介包含‘系统’、‘逆袭’关键词的作品，平均初始热度高出30%。”*
    *   *“字数在 50-80万字 区间且状态为 `连载中` 的作品，热度爬升最快。”*

#### **2. 断更/完结热度衰减模型**
*   **分析逻辑**：监控 `status` 变为“已完结”后，`numeric_popularity` 的衰减曲线。
*   **涉及字段**：`status`, `updated_at`, `rank_date`。
*   **策略建议**：计算最佳“完结时长”，建议作者在热度衰减至 20% 前推出新书，利用老书余热导流。

---

### **三、读者侧：避免“热度噪音”的个性化推荐**

**核心目标**：解决“热门但不合口味”的问题，利用热度进行分层推荐。

#### **1. 小众热度挖掘（圈层爆款）**
*   **分析逻辑**：不看全局热度，看**分类内相对热度**。
*   **涉及字段**：`category1_name`, `gender_type`, `score`。
*   **SQL 场景**：
    *   在 `gender_type = 'male'` 且 `category1_name = '科幻'` 的小圈子里，寻找 `score > 9.0` 且 `numeric_popularity` 排名 Top 5 的书，即使它们在全站总榜上排不到前100。

#### **2. 避坑指南（高热低分预警）**
*   **分析逻辑**：识别“刷榜”或“黑红”特征。
*   **指标计算**：计算 `numeric_popularity` 与 `score` 的比率。如果热度极高但评分极低（<6.0），则在推荐算法中降权。

---

### **四、资本侧：IP 价值评估的“热度积分模型”**

**核心目标**：评估小说改编（影视/游戏/动漫）的长期变现潜力。

#### **1. IP 长尾价值计算（LTV）**
*   **分析逻辑**：热度积分（Heat Integral）。计算一本书在时间轴上 `numeric_popularity` 的累积面积，而不仅仅是峰值。
*   **涉及字段**：`rank_date`, `numeric_popularity`, `date_month`。
*   **决策支持**：
    *   **短线IP**：爆发快，衰减快（适合短剧改编）。
    *   **长线IP**：热度平稳上升，持续时间长，累积积分高（适合出版、动漫实体化）。

#### **2. 粉丝粘性与购买力验证**
*   **分析逻辑**：利用 `number`（榜单排名数值）和 `read_count` 的比对。
*   **涉及字段**：`unit`（单位）, `read_count`。
*   **假设**：如果 `read_count`（阅读人数）相对较低，但 `rank_name`（如打赏榜/月票榜）很高，说明核心粉丝付费能力极强（ARPU高），是优质资本标的。