# Cursor 提示词

## 数据库设计与处理流程

### 1. 数据导入与层次划分
- **ODS层（原始数据）**：
  - 将 `Seven_Cats_Novel_Data` 表从 MySQL 导入到 Hive 数据库 `hive_QimaoScraper` 中。
  - 数据表名称：`ods_novel_data`，此表为原始数据表，不做清理。

- **DWD层（数据清理）**：
  - 数据清理处理，包括：
    - 删除含有空列的表。
    - 处理缺失值（如通过平均值填充）。
    - 异常值处理（如使用中位数填充）。
  - 数据表名称：`dwd_novel_data`，此表为清理后的数据表。

- **ADS层（特征工程与数据可视化）**：
  - 在 `dwd_novel_data` 基础上，进行特征工程、生成特征表。
  - 创建针对不同侧的特征表：
    - `ads_platform_heat`：平台侧热度分析。
    - `ads_platform_ranking_trend`：平台侧榜单趋势分析。
    - `ads_auther`：作者侧分析。
    - `ads_user`：用户侧分析。
    - `ads_capital`：资本侧分析。
  - 将 ADS 层的表通过 **Sqoop** 导入到 MySQL 数据库 `QimaoScraper_Feature_Data`。

### 2. 数据处理与转化
- **数据标准化**：
  - 将 `popularity` 和 `read_count` 等字段的 `varchar` 类型转为数值型，并进行单位统一（例如将 “万” 转为 10000）。
  - 创建 **热度指数** 作为生成列 (Generated Column)。
  - SQL 示例：
    ```sql
    ALTER TABLE Seven_Cats_Novel_Data
    ADD COLUMN numeric_popularity DECIMAL(15,2) GENERATED ALWAYS AS (
        CASE 
            WHEN popularity LIKE '%亿%' THEN REPLACE(popularity, '亿', '') * 100000000
            WHEN popularity LIKE '%万%' THEN REPLACE(popularity, '万', '') * 10000
            ELSE popularity 
        END
    ) STORED,
    ADD INDEX idx_numeric_pop (numeric_popularity);
    ```

## 四大分析侧详细设计

### 1. **平台侧：热度加速度与流量分发**
- **目标**：识别热度爆发期作品，优化流量分发与广告竞价。
  - **热度飙升算法（Traffic Boosting）**：
    - 分析作品的热度差值变化，识别热度加速的作品。
    - 关注 `book_id`, `numeric_popularity`, `rank_date`, `category1_name` 字段。
    - SQL 场景：
      - 环比增速分析：筛选昨日与今日热度差值超过阈值的作品。
  - **榜单马太效应分析**：
    - 通过 `rank_name` 和 `read_count` 分析榜单中的作品是否存在转化问题。

### 2. **作者侧：热度归因与创作指导**
- **目标**：帮助作者理解热度背后的原因，调整创作方向。
  - **黄金元素提取**：
    - 利用 `intro` 和 `title` 进行分词处理，结合热度与标签相关性分析。
    - 输出关键热度关联元素，如“字数区间、题材关键词等”。
  - **完结热度衰减模型**：
    - 分析作品从连载到完结后的热度变化，建议作者在热度衰减前更新作品。

### 3. **读者侧：个性化推荐与热度噪音消除**
- **目标**：基于热度与评分的分层推荐系统，避免热门但不合口味的书籍推荐。
  - **小众热度挖掘**：
    - 根据 `category1_name`, `gender_type`, `score` 提供分类内的推荐，避免全站热门但不符合特定口味的书籍。
  - **避免高热低分预警**：
    - 对比热度与评分，自动降低热度高但评分低的作品权重。

### 4. **资本侧：IP价值与长期潜力评估**
- **目标**：评估作品的长期变现潜力，特别是在影视改编等方面。
  - **IP长尾价值计算（LTV）**：
    - 通过计算作品的热度积分（`numeric_popularity` 累积面积），分析长期潜力。
  - **粉丝粘性与购买力验证**：
    - 结合 `rank_name`, `read_count` 分析作品的粉丝粘性，识别潜力作品。

## 总结与执行步骤

1. **数据导入**：通过 **Sqoop** 导入数据到 Hive，再从 Hive 导入 ADS 层的数据表到 MySQL。
2. **数据清理与标准化**：创建数值化的热度指数，确保可以用于后续的分析和模型训练。
3. **特征工程与分析模型**：
   - 基于不同分析侧，生成相关的 ADS 表并进行热度、作者、读者和资本侧的分析。
4. **数据可视化**：通过 MySQL 数据进行深入分析与可视化，展示四个分析侧的核心指标与趋势。

---

以上为优化后的 **cursor 提示词**，提供了详细的数据库设计、数据清理标准化步骤，以及针对平台、作者、读者和资本侧的具体分析方法和目标。
