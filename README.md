# ä¸ƒçŒ«å°è¯´æ•°æ®ä»“åº“é¡¹ç›®

<p align="center">
  <img src="https://img.shields.io/badge/Python-3.8+-blue.svg" alt="Python Version">
  <img src="https://img.shields.io/badge/PySpark-3.0+-orange.svg" alt="PySpark Version">
  <img src="https://img.shields.io/badge/MySQL-8.0+-green.svg" alt="MySQL Version">
  <img src="https://img.shields.io/badge/Hive-3.0+-yellow.svg" alt="Hive Version">
  <img src="https://img.shields.io/badge/License-MIT-red.svg" alt="License">
</p>

## ğŸ“– é¡¹ç›®ç®€ä»‹

æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªå®Œæ•´çš„**ç½‘ç»œå°è¯´æ•°æ®ä»“åº“è§£å†³æ–¹æ¡ˆ**ï¼Œä¸“æ³¨äºä¸ƒçŒ«å°è¯´å¹³å°çš„æ•°æ®é‡‡é›†ã€å¤„ç†ã€åˆ†æå’Œä»·å€¼æŒ–æ˜ã€‚é‡‡ç”¨ç»å…¸çš„ä¸‰å±‚æ•°æ®ä»“åº“æ¶æ„ï¼ˆODS â†’ DWD â†’ ADSï¼‰ï¼Œä»**å¹³å°è¿è¥ã€ä½œè€…åˆ›ä½œã€ç”¨æˆ·é˜…è¯»ã€èµ„æœ¬æŠ•èµ„**å››å¤§ç»´åº¦è¿›è¡Œæ·±åº¦æ•°æ®åˆ†æï¼Œä¸ºç½‘æ–‡è¡Œä¸šæä¾›æ•°æ®é©±åŠ¨çš„å†³ç­–æ”¯æŒã€‚

### ğŸ¯ æ ¸å¿ƒç‰¹æ€§

- âœ… **å®Œæ•´çš„ETLæµç¨‹**ï¼šä»æ•°æ®é‡‡é›†åˆ°å¯è§†åŒ–çš„å…¨é“¾è·¯æ•°æ®å¤„ç†
- âœ… **å››ç»´åº¦åˆ†æä½“ç³»**ï¼šå¹³å°ä¾§ã€ä½œè€…ä¾§ã€ç”¨æˆ·ä¾§ã€èµ„æœ¬ä¾§å…¨æ–¹ä½æ´å¯Ÿ
- âœ… **8å¤§ç‰¹å¾è¡¨**ï¼šæ¶µç›–çƒ­åº¦åˆ†æã€æ¦œå•è¶‹åŠ¿ã€IPä»·å€¼è¯„ä¼°ç­‰æ ¸å¿ƒä¸šåŠ¡åœºæ™¯
- âœ… **è‡ªåŠ¨åŒ–æ‰§è¡Œ**ï¼šæ”¯æŒä¸€é”®è¿è¡Œå®Œæ•´æ•°æ®ä»“åº“å¤„ç†æµç¨‹
- âœ… **å¯æ‰©å±•æ¶æ„**ï¼šæ¨¡å—åŒ–è®¾è®¡ï¼Œæ˜“äºæ‰©å±•æ–°çš„åˆ†æç»´åº¦

### ğŸ—ï¸ æŠ€æœ¯æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        æ•°æ®é‡‡é›†å±‚                                 â”‚
â”‚                  Scrapy åˆ†å¸ƒå¼çˆ¬è™«æ¡†æ¶                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        æ•°æ®å­˜å‚¨å±‚                                 â”‚
â”‚        MySQL (æºæ•°æ®) â†’ Hive (ODS/DWD/ADS) â†’ MySQL (åº”ç”¨)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        æ•°æ®å¤„ç†å±‚                                 â”‚
â”‚              PySpark åˆ†å¸ƒå¼è®¡ç®— + ç‰¹å¾å·¥ç¨‹                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        æ•°æ®åº”ç”¨å±‚                                 â”‚
â”‚              BIå¯è§†åŒ– / APIæœåŠ¡ / æœºå™¨å­¦ä¹                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“š æŠ€æœ¯æ ˆ

| æŠ€æœ¯é¢†åŸŸ | ä½¿ç”¨æŠ€æœ¯ | è¯´æ˜ |
|---------|---------|------|
| **æ•°æ®é‡‡é›†** | Scrapy 2.x | åˆ†å¸ƒå¼çˆ¬è™«æ¡†æ¶ï¼Œæ”¯æŒæ–­ç‚¹ç»­ä¼  |
| **æ•°æ®å­˜å‚¨** | MySQL 8.0+, Apache Hive 3.x | å…³ç³»å‹æ•°æ®åº“ + åˆ†å¸ƒå¼æ•°æ®ä»“åº“ |
| **æ•°æ®å¤„ç†** | PySpark 3.0+ | åˆ†å¸ƒå¼æ•°æ®å¤„ç†ä¸ç‰¹å¾å·¥ç¨‹ |
| **æ•°æ®å¯¼å‡º** | PySpark JDBC | é«˜æ€§èƒ½æ•°æ®å¯¼å‡º |
| **å¼€å‘è¯­è¨€** | Python 3.8+ | ç»Ÿä¸€å¼€å‘è¯­è¨€ |
| **è¿è¡Œç¯å¢ƒ** | Linux / Windows | æ”¯æŒè·¨å¹³å°éƒ¨ç½² |

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
QimaoScraper/
â”‚
â”œâ”€â”€ Spider_New/                          # ğŸ•·ï¸ æ•°æ®é‡‡é›†æ¨¡å—
â”‚   â”œâ”€â”€ qimao_scrapy/                   # Scrapyçˆ¬è™«é¡¹ç›®
â”‚   â”‚   â”œâ”€â”€ spiders/                    # çˆ¬è™«è„šæœ¬
â”‚   â”‚   â”‚   â””â”€â”€ qimao_spider.py        # ä¸ƒçŒ«æ¦œå•ä¸è¯¦æƒ…çˆ¬è™«
â”‚   â”‚   â”œâ”€â”€ items.py                   # æ•°æ®é¡¹å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ pipelines.py               # æ•°æ®ç®¡é“ï¼ˆå…¥åº“ï¼‰
â”‚   â”‚   â”œâ”€â”€ middlewares.py             # ä¸­é—´ä»¶ï¼ˆä»£ç†/UAè½®æ¢ï¼‰
â”‚   â”‚   â”œâ”€â”€ settings.py                # çˆ¬è™«é…ç½®
â”‚   â”‚   â””â”€â”€ db_utils.py                # MySQLè¿æ¥å·¥å…·
â”‚   â”œâ”€â”€ run_scrapy.py                  # çˆ¬è™«å¯åŠ¨è„šæœ¬
â”‚   â”œâ”€â”€ Spider_data.py                 # æ•°æ®é‡‡é›†å·¥å…·
â”‚   â”œâ”€â”€ scrapy.cfg                     # Scrapyé…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ qimao_books.json               # ä¹¦ç±æ•°æ®ç¼“å­˜
â”‚
â”œâ”€â”€ database/                            # ğŸ“Š æ•°æ®åº“å»ºè¡¨è„šæœ¬
â”‚   â”œâ”€â”€ QimaoScraper.sql               # æºæ•°æ®åº“è¡¨ç»“æ„ï¼ˆSeven_Cats_Novel_Dataï¼‰
â”‚   â””â”€â”€ QimaoScraper_Feature_Data.sql  # ç‰¹å¾æ•°æ®åº“è¡¨ç»“æ„ï¼ˆ8ä¸ªADSè¡¨ï¼‰
â”‚
â”œâ”€â”€ Data_visualisation/                  # ğŸ”§ æ•°æ®å¤„ç†æ¨¡å—
â”‚   â”œâ”€â”€ config.py                      # âš™ï¸ é…ç½®æ–‡ä»¶ï¼ˆMySQL/Hive/Sparké…ç½®ï¼‰
â”‚   â”œâ”€â”€ main.py                        # ğŸš€ ä¸»æ‰§è¡Œè„šæœ¬ï¼ˆä¸€é”®è¿è¡ŒETLï¼‰
â”‚   â”œâ”€â”€ Spark_MySQL_to_Hive.py         # æ­¥éª¤1: MySQL â†’ Hive ODS
â”‚   â”œâ”€â”€ Spark_Data_processing.py       # æ­¥éª¤2: ODS â†’ DWD æ•°æ®æ¸…æ´—
â”‚   â”œâ”€â”€ Spark_dwd_to_ads.py            # æ­¥éª¤3: DWD â†’ ADS ç‰¹å¾å·¥ç¨‹ï¼ˆ8è¡¨ï¼‰
â”‚   â”œâ”€â”€ Sqoop_hive_to_MySQL.py         # æ­¥éª¤4: Hive ADS â†’ MySQL å¯¼å‡º
â”‚   â””â”€â”€ é¡¹ç›®æ‰§è¡Œ/                       # ğŸ“„ é¡¹ç›®æ–‡æ¡£
â”‚       â”œâ”€â”€ æ•°ä»“å»ºæ¨¡æ–¹æ¡ˆ.md             # æ•°æ®ä»“åº“å»ºæ¨¡è®¾è®¡æ–‡æ¡£
â”‚       â”œâ”€â”€ æ‰§è¡Œæ–¹æ¡ˆ.md                 # å››ç»´åº¦åˆ†ææ‰§è¡Œæ–¹æ¡ˆ
â”‚       â””â”€â”€ å¼€å‘æç¤ºè¯.md               # å¼€å‘è¯´æ˜ä¸æç¤º
â”‚
â”œâ”€â”€ img/                                 # ğŸ“· é¡¹ç›®æˆªå›¾
â”‚   â””â”€â”€ *.png                          # æ‰§è¡Œç»“æœæˆªå›¾
â”‚
â””â”€â”€ README.md                            # ğŸ“– é¡¹ç›®è¯´æ˜æ–‡æ¡£ï¼ˆæœ¬æ–‡ä»¶ï¼‰
```

---

## ğŸ›ï¸ æ•°æ®ä»“åº“æ¶æ„

### æ•°æ®æµè½¬å…¨æ™¯

```
ã€æ•°æ®æºã€‘
  ä¸ƒçŒ«å°è¯´ç½‘ç«™API
       â†“
ã€é‡‡é›†å±‚ã€‘Scrapyçˆ¬è™«
       â†“
ã€æºæ•°æ®åº“ã€‘MySQL.QimaoScraper.Seven_Cats_Novel_Data
       â†“ (Spark JDBC å…¨é‡/å¢é‡å¯¼å…¥)
ã€ODSå±‚ã€‘Hive.hive_QimaoScraper.ods_novel_data
       â†“ (æ•°æ®æ¸…æ´—: ç©ºå€¼å¤„ç†ã€å¼‚å¸¸å€¼å¤„ç†ã€æ•°å€¼åŒ–è½¬æ¢)
ã€DWDå±‚ã€‘Hive.hive_QimaoScraper.dwd_novel_data
       â†“ (ç‰¹å¾å·¥ç¨‹: 8ä¸ªç»´åº¦è¡¨ç”Ÿæˆ)
ã€ADSå±‚ã€‘Hive.hive_QimaoScraper.ads_* (8å¼ ç‰¹å¾è¡¨)
       â†“ (Spark JDBC å¯¼å‡ºåˆ°åº”ç”¨æ•°æ®åº“)
ã€åº”ç”¨å±‚ã€‘MySQL.QimaoScraper_Feature_Data.ads_* (8å¼ è¡¨)
       â†“
ã€å¯è§†åŒ–/API/MLã€‘BIæŠ¥è¡¨ã€æ¨èç³»ç»Ÿã€ä»·å€¼è¯„ä¼°
```

### ğŸ“Š åˆ†å±‚è®¾è®¡è¯¦è§£

#### 1ï¸âƒ£ ODSå±‚ï¼ˆOperational Data Store - åŸå§‹æ•°æ®å±‚ï¼‰

- **æ•°æ®åº“**: `hive_QimaoScraper`
- **è¡¨å**: `ods_novel_data`
- **æ•°æ®æ¥æº**: ä» MySQL çš„ `Seven_Cats_Novel_Data` è¡¨å…¨é‡åŒæ­¥
- **å¤„ç†åŸåˆ™**: **ä¸åšä»»ä½•æ¸…æ´—**ï¼Œä¿æŒåŸå§‹æ•°æ®çŠ¶æ€ï¼Œæ”¯æŒæ•°æ®å›æº¯
- **æ›´æ–°æ–¹å¼**: æ”¯æŒå…¨é‡è¦†ç›–æˆ–å¢é‡è¿½åŠ 

#### 2ï¸âƒ£ DWDå±‚ï¼ˆData Warehouse Detail - æ˜ç»†æ•°æ®å±‚ï¼‰

- **æ•°æ®åº“**: `hive_QimaoScraper`
- **è¡¨å**: `dwd_novel_data`
- **å¤„ç†é€»è¾‘**:
  1. **ç©ºå€¼å¤„ç†**: åˆ é™¤å…¨ç©ºåˆ—ã€å…¨ç©ºè¡Œ
  2. **ç¼ºå¤±å€¼å¡«å……**: æ•°å€¼å­—æ®µç”¨å¹³å‡å€¼å¡«å……
  3. **å¼‚å¸¸å€¼å¤„ç†**: ä½¿ç”¨3å€IQRæ³•åˆ™ï¼Œç”¨ä¸­ä½æ•°æ›¿æ¢å¼‚å¸¸å€¼
  4. **æ•°å€¼åŒ–è½¬æ¢**: å°†å¸¦å•ä½çš„å­—ç¬¦ä¸²è½¬ä¸ºæ•°å€¼ï¼ˆå¦‚ "123.5ä¸‡" â†’ 1235000ï¼‰
     - `popularity` â†’ `numeric_popularity`
     - `read_count` â†’ `numeric_read_count`
     - `score` â†’ `numeric_score`
     - `words_num` â†’ `numeric_words`

#### 3ï¸âƒ£ ADSå±‚ï¼ˆApplication Data Store - åº”ç”¨æ•°æ®å±‚ï¼‰

- **æ•°æ®åº“**: `hive_QimaoScraper` (Hive) / `QimaoScraper_Feature_Data` (MySQL)
- **è¡¨æ•°é‡**: **8å¼ ç‰¹å¾è¡¨**ï¼Œåˆ†ä¸ºå››å¤§ä¸šåŠ¡ç»´åº¦
- **å¤„ç†é€»è¾‘**: åŸºäºDWDå±‚æ•°æ®è¿›è¡Œç‰¹å¾å·¥ç¨‹ï¼Œç”Ÿæˆé¢å‘ä¸šåŠ¡åœºæ™¯çš„åˆ†æè¡¨

---

## ğŸ¯ å››å¤§åˆ†æç»´åº¦ä¸8å¼ ç‰¹å¾è¡¨

### ğŸ¢ ä¸€ã€å¹³å°ä¾§åˆ†æï¼ˆPlatform Analyticsï¼‰

**ä¸šåŠ¡ç›®æ ‡**: ä¼˜åŒ–æµé‡åˆ†å‘ç­–ç•¥ï¼Œæå‡å¹³å°GMV

#### ğŸ“ˆ è¡¨1: `ads_platform_heat` - çƒ­åº¦åˆ†æè¡¨

**ç”¨é€”**: ç›‘æ§ä½œå“çƒ­åº¦å˜åŒ–è¶‹åŠ¿ï¼Œè¯†åˆ«çˆ†æ¬¾ä½œå“

| æ ¸å¿ƒæŒ‡æ ‡ | è¯´æ˜ | ä¸šåŠ¡ä»·å€¼ |
|---------|------|---------|
| `popularity_diff` | ä¸€é˜¶å¯¼æ•°ï¼ˆçƒ­åº¦æ—¥å¢é‡ï¼‰ | è¯†åˆ«å¿«é€Ÿå¢é•¿çš„ä½œå“ |
| `popularity_acceleration` | äºŒé˜¶å¯¼æ•°ï¼ˆå¢é•¿åŠ é€Ÿåº¦ï¼‰ | é¢„æµ‹çƒ­åº¦çˆ†å‘æ‹ç‚¹ |
| `is_cold_start_quality` | å†·å¯åŠ¨è´¨é‡æ ‡è¯† | æŒ–æ˜æ–°ä¹¦æ½œåŠ›è‚¡ |
| `heat_surge_flag` | çƒ­åº¦é£™å‡æ ‡è®° | è‡ªåŠ¨æ¨èä½åˆ†é… |

**SQLæŸ¥è¯¢ç¤ºä¾‹**:
```sql
-- æŸ¥è¯¢ä»Šæ—¥çƒ­åº¦é£™å‡çš„TOP10ä½œå“
SELECT book_id, title, popularity_diff, popularity_acceleration
FROM ads_platform_heat
WHERE heat_surge_flag = 1 AND rank_date = CURRENT_DATE
ORDER BY popularity_acceleration DESC
LIMIT 10;
```

#### ğŸ“Š è¡¨2: `ads_platform_ranking_trend` - æ¦œå•è¶‹åŠ¿åˆ†æè¡¨

**ç”¨é€”**: åˆ†ææ¦œå•è½¬åŒ–æ•ˆç‡ï¼Œè¯†åˆ«"å¾·ä¸é…ä½"ä½œå“

| æ ¸å¿ƒæŒ‡æ ‡ | è¯´æ˜ | ä¸šåŠ¡ä»·å€¼ |
|---------|------|---------|
| `ranking_conversion_rate` | æ¦œå•è½¬åŒ–ç‡ï¼ˆä¸Šæ¦œâ†’é˜…è¯»å¢é•¿ï¼‰ | è¯„ä¼°æ¦œå•æ¨èæ•ˆæœ |
| `is_unworthy` | å¾·ä¸é…ä½æ ‡è¯†ï¼ˆé«˜æ¦œä½ä½è½¬åŒ–ï¼‰ | é™æƒä½æ•ˆæ¨èä½ |
| `recommend_weight` | æ¨èæƒé‡ç³»æ•° | åŠ¨æ€è°ƒæ•´æ¨èç­–ç•¥ |
| `ranking_stability` | æ¦œå•ç¨³å®šæ€§ | è¯†åˆ«é•¿å°¾ä»·å€¼ä½œå“ |

**åº”ç”¨åœºæ™¯**: 
- è‡ªåŠ¨è°ƒæ•´æ¨èä½æƒé‡
- è¯†åˆ«åˆ·æ¦œè¡Œä¸º
- ä¼˜åŒ–å¹¿å‘Šç«ä»·ç­–ç•¥

---

### âœï¸ äºŒã€ä½œè€…ä¾§åˆ†æï¼ˆAuthor Analyticsï¼‰

**ä¸šåŠ¡ç›®æ ‡**: ä¸ºä½œè€…æä¾›åˆ›ä½œæŒ‡å¯¼ï¼Œæå‡å¹³å°ä½œå“è´¨é‡

#### ğŸ” è¡¨3: `ads_author_reason` - çƒ­åº¦åŸå› åˆ†æè¡¨

**ç”¨é€”**: åˆ†æçƒ­åº¦èƒŒåçš„å…³é”®å› ç´ 

| æ ¸å¿ƒæŒ‡æ ‡ | è¯´æ˜ | ä¸šåŠ¡ä»·å€¼ |
|---------|------|---------|
| `has_hot_keywords` | æ˜¯å¦åŒ…å«çƒ­é—¨å…³é”®è¯ | é¢˜æé€‰æ‹©æŒ‡å¯¼ |
| `is_golden_range` | æ˜¯å¦å¤„äºé»„é‡‘å­—æ•°åŒºé—´ | è¿è½½èŠ‚å¥å»ºè®® |
| `heat_index` | ç»¼åˆçƒ­åº¦æŒ‡æ•° | ä½œå“è´¨é‡è¯„åˆ† |
| `category_avg_heat` | åˆ†ç±»å¹³å‡çƒ­åº¦ | ç›¸å¯¹ç«äº‰åŠ›åˆ†æ |

**ä¸šåŠ¡æ´å¯Ÿè¾“å‡º**:
- *"éƒ½å¸‚åˆ†ç±»ä¸­ï¼ŒåŒ…å«'ç³»ç»Ÿ'ã€'é€†è¢­'å…³é”®è¯çš„ä½œå“ï¼Œå¹³å‡åˆå§‹çƒ­åº¦é«˜å‡º30%"*
- *"50-80ä¸‡å­—ä¸”è¿è½½ä¸­çš„ä½œå“ï¼Œçƒ­åº¦å¢é•¿æœ€å¿«"*

#### ğŸ“‰ è¡¨4: `ads_author_attenuation_effect` - çƒ­åº¦è¡°å‡æ•ˆåº”è¡¨

**ç”¨é€”**: åˆ†æå®Œç»“åçš„çƒ­åº¦è¡°å‡è§„å¾‹

| æ ¸å¿ƒæŒ‡æ ‡ | è¯´æ˜ | ä¸šåŠ¡ä»·å€¼ |
|---------|------|---------|
| `attenuation_rate` | è¡°å‡ç‡ï¼ˆå®Œç»“åçƒ­åº¦ä¸‹é™æ¯”ä¾‹ï¼‰ | é¢„æµ‹ä½œå“ç”Ÿå‘½å‘¨æœŸ |
| `attenuation_type` | è¡°å‡ç±»å‹ï¼ˆå¿«é€Ÿ/å¹³ç¨³/ç¼“æ…¢ï¼‰ | åˆ†ç±»ç®¡ç†ç­–ç•¥ |
| `recommended_new_book_days` | å»ºè®®æ–°ä¹¦å‘å¸ƒæ—¶é—´ï¼ˆå¤©ï¼‰ | æœ€ä½³ç»­ä½œæ—¶æœº |
| `days_since_completion` | å®Œç»“åå¤©æ•° | è¡°å‡æ›²çº¿ç›‘æ§ |

**ç­–ç•¥å»ºè®®**: 
- è®¡ç®—æœ€ä½³"å®Œç»“æ—¶é•¿"
- å»ºè®®ä½œè€…åœ¨çƒ­åº¦è¡°å‡è‡³20%å‰æ¨å‡ºæ–°ä¹¦
- åˆ©ç”¨è€ä¹¦ä½™çƒ­å¯¼æµ

---

### ğŸ‘¥ ä¸‰ã€ç”¨æˆ·ä¾§åˆ†æï¼ˆUser Analyticsï¼‰

**ä¸šåŠ¡ç›®æ ‡**: ä¼˜åŒ–ä¸ªæ€§åŒ–æ¨èï¼Œæå‡ç”¨æˆ·æ»¡æ„åº¦

#### ğŸ¯ è¡¨5: `ads_user_layered_recommendation` - åˆ†å±‚æ¨èè¡¨

**ç”¨é€”**: æŒ–æ˜å°ä¼—çˆ†æ¬¾ï¼Œé¿å…çƒ­åº¦å™ªéŸ³

| æ ¸å¿ƒæŒ‡æ ‡ | è¯´æ˜ | ä¸šåŠ¡ä»·å€¼ |
|---------|------|---------|
| `relative_heat` | åˆ†ç±»å†…ç›¸å¯¹çƒ­åº¦ | åœˆå±‚çˆ†æ¬¾è¯†åˆ« |
| `is_niche_hit` | å°ä¼—çˆ†æ¬¾æ ‡è¯† | é•¿å°¾æ¨èä¼˜åŒ– |
| `niche_recommendation_score` | å°ä¼—æ¨èåˆ†æ•° | ä¸ªæ€§åŒ–æ¨èæ’åº |
| `category_rank` | åˆ†ç±»å†…æ’å | ç›¸å¯¹ç«äº‰åŠ› |

**æ¨èç­–ç•¥**:
- ä¸çœ‹å…¨å±€çƒ­åº¦ï¼Œçœ‹**åˆ†ç±»å†…ç›¸å¯¹çƒ­åº¦**
- åœ¨"ç”·é¢‘-ç§‘å¹»"å°åœˆå­é‡Œï¼Œæ¨èè¯„åˆ†>9.0çš„TOP5
- é¿å…"çƒ­é—¨ä½†ä¸åˆå£å‘³"çš„é—®é¢˜

#### âš ï¸ è¡¨6: `ads_user_avoid_pitfalls` - é¿å‘æŒ‡å—è¡¨

**ç”¨é€”**: è¯†åˆ«é«˜çƒ­ä½åˆ†ä½œå“ï¼Œé˜²åˆ·æ¦œæœºåˆ¶

| æ ¸å¿ƒæŒ‡æ ‡ | è¯´æ˜ | ä¸šåŠ¡ä»·å€¼ |
|---------|------|---------|
| `is_suspicious_boost` | ç–‘ä¼¼åˆ·æ¦œæ ‡è¯† | é£æ§é¢„è­¦ |
| `risk_level` | é£é™©ç­‰çº§ï¼ˆæ­£å¸¸/å¯ç–‘/é«˜å±ï¼‰ | é™æƒå†³ç­– |
| `avoidance_advice` | é¿å‘å»ºè®® | ç”¨æˆ·æç¤ºä¿¡æ¯ |
| `heat_score_ratio` | çƒ­åº¦è¯„åˆ†æ¯”ï¼ˆå¼‚å¸¸è¯†åˆ«ï¼‰ | åˆ·æ¦œæ£€æµ‹ |

**é£æ§è§„åˆ™**:
- çƒ­åº¦>300ä¸‡ ä¸” è¯„åˆ†<6.0 â†’ é«˜é£é™©
- çƒ­åº¦>100ä¸‡ ä¸” è¯„åˆ†<7.0 â†’ å¯ç–‘
- åœ¨æ¨èç®—æ³•ä¸­é™æƒ

---

### ğŸ’° å››ã€èµ„æœ¬ä¾§åˆ†æï¼ˆCapital Analyticsï¼‰

**ä¸šåŠ¡ç›®æ ‡**: è¯„ä¼°IPé•¿æœŸä»·å€¼ï¼Œæ”¯æŒæŠ•èµ„å†³ç­–

#### ğŸ’ è¡¨7: `ads_capital_ltv` - IPé•¿å°¾ä»·å€¼è®¡ç®—è¡¨ï¼ˆLTVï¼‰

**ç”¨é€”**: è®¡ç®—IPçš„é•¿æœŸå˜ç°æ½œåŠ›

| æ ¸å¿ƒæŒ‡æ ‡ | è¯´æ˜ | ä¸šåŠ¡ä»·å€¼ |
|---------|------|---------|
| `total_heat_integral` | çƒ­åº¦ç§¯åˆ†ï¼ˆæ—¶é—´è½´ç´¯ç§¯é¢ç§¯ï¼‰ | é•¿æœŸä»·å€¼è¯„ä¼° |
| `ltv_score` | LTVåˆ†æ•° | æŠ•èµ„å†³ç­–ä¾æ® |
| `ip_value_level` | IPä»·å€¼ç­‰çº§ï¼ˆS/A/B/Cï¼‰ | å¿«é€Ÿç­›é€‰æ ‡çš„ |
| `adaptation_suggestion` | æ”¹ç¼–å»ºè®®ï¼ˆçŸ­å‰§/é•¿å‰§/åŠ¨æ¼«/æ¸¸æˆï¼‰ | å•†ä¸šåŒ–è·¯å¾„ |

**å†³ç­–æ”¯æŒ**:
- **çŸ­çº¿IP**: çˆ†å‘å¿«ï¼Œè¡°å‡å¿«ï¼ˆé€‚åˆçŸ­å‰§æ”¹ç¼–ï¼‰
- **é•¿çº¿IP**: çƒ­åº¦å¹³ç¨³ä¸Šå‡ï¼ŒæŒç»­æ—¶é—´é•¿ï¼ˆé€‚åˆå‡ºç‰ˆã€åŠ¨æ¼«ï¼‰

**è®¡ç®—å…¬å¼**:
```
LTVåˆ†æ•° = çƒ­åº¦ç§¯åˆ† Ã— (1 + log10(ç”Ÿå‘½å‘¨æœŸå¤©æ•°)) Ã— æ”¹ç¼–é€‚é…åº¦ç³»æ•°
```

#### ğŸ’¸ è¡¨8: `ads_capital_future_purchasing_power` - ç²‰ä¸ç²˜æ€§ä¸è´­ä¹°åŠ›éªŒè¯è¡¨

**ç”¨é€”**: éªŒè¯ç²‰ä¸çš„ä»˜è´¹èƒ½åŠ›ï¼ˆARPUåˆ†æï¼‰

| æ ¸å¿ƒæŒ‡æ ‡ | è¯´æ˜ | ä¸šåŠ¡ä»·å€¼ |
|---------|------|---------|
| `avg_arpu` | å¹³å‡ARPUå€¼ï¼ˆçƒ­åº¦/é˜…è¯»é‡ï¼‰ | ä»˜è´¹èƒ½åŠ›è¯„ä¼° |
| `fan_value_score` | ç²‰ä¸ä»·å€¼åˆ†æ•° | æ ¸å¿ƒç²‰ä¸è¯†åˆ« |
| `investment_value_level` | æŠ•èµ„ä»·å€¼ç­‰çº§ï¼ˆä¼˜è´¨/è‰¯å¥½/ä¸€èˆ¬/è¾ƒå·®ï¼‰ | æŠ•èµ„ä¼˜å…ˆçº§ |
| `investment_recommendation` | æŠ•èµ„å»ºè®® | å†³ç­–å‚è€ƒ |

**å‡è®¾éªŒè¯**:
- å¦‚æœ `read_count` ä½ï¼Œä½† `rank_name`ï¼ˆæ‰“èµæ¦œ/æœˆç¥¨æ¦œï¼‰é«˜
- è¯´æ˜æ ¸å¿ƒç²‰ä¸ä»˜è´¹èƒ½åŠ›æå¼ºï¼ˆARPUé«˜ï¼‰
- æ˜¯ä¼˜è´¨èµ„æœ¬æ ‡çš„

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

| ç»„ä»¶ | ç‰ˆæœ¬è¦æ±‚ | è¯´æ˜ |
|------|---------|------|
| Python | 3.8+ | æ¨èä½¿ç”¨Anacondaç¯å¢ƒ |
| PySpark | 3.0+ | éœ€è¦é…ç½®JAVA_HOME |
| MySQL | 8.0+ | æ”¯æŒUTF8MB4å­—ç¬¦é›† |
| Apache Hive | 3.0+ | éœ€å¯åŠ¨MetastoreæœåŠ¡ |
| æ“ä½œç³»ç»Ÿ | Linux/Windows | æ¨èLinuxç¯å¢ƒ |

### å®‰è£…ä¾èµ–

```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼ˆæ¨èï¼‰
conda create -n qimao python=3.8
conda activate qimao

# å®‰è£…Pythonä¾èµ–
pip install pyspark==3.1.2
pip install pymysql
pip install scrapy
pip install pandas
```

### é…ç½®ä¿®æ”¹

ç¼–è¾‘ [Data_visualisation/config.py](Data_visualisation/config.py) æ–‡ä»¶ï¼š

```python
# MySQLé…ç½®
MYSQL_CONFIG = {
    "host": "your_mysql_host",          # ä¿®æ”¹ä¸ºä½ çš„MySQLåœ°å€
    "port": 3306,
    "database": "QimaoScraper",
    "target_database": "QimaoScraper_Feature_Data",
    "user": "root",
    "password": "your_password",        # ä¿®æ”¹ä¸ºä½ çš„MySQLå¯†ç 
    "charset": "utf8mb4"
}

# Hiveé…ç½®
HIVE_CONFIG = {
    "database": "hive_QimaoScraper",
    "metastore_uri": "thrift://localhost:9083",  # ä¿®æ”¹ä¸ºä½ çš„Hive Metastoreåœ°å€
    "warehouse_dir": "/user/hive/warehouse"
}
```

### åˆå§‹åŒ–æ•°æ®åº“

```bash
# 1. åˆ›å»ºæºæ•°æ®åº“
mysql -u root -p < database/QimaoScraper.sql

# 2. åˆ›å»ºç‰¹å¾æ•°æ®åº“
mysql -u root -p < database/QimaoScraper_Feature_Data.sql

# 3. å¯åŠ¨Hive Metastoreï¼ˆLinuxç¯å¢ƒï¼‰
nohup hive --service metastore &
```

---

## ğŸ“‹ æ‰§è¡Œæµç¨‹

### æ–¹å¼ä¸€ï¼šä¸€é”®è¿è¡Œå®Œæ•´æµç¨‹

```bash
cd Data_visualisation

# è¿è¡Œå®Œæ•´ETLæµç¨‹ï¼ˆæ­¥éª¤1-4ï¼‰
python main.py --all

# æˆ–åˆ†æ­¥æ‰§è¡Œ
python main.py --step 1  # MySQL â†’ Hive ODS
python main.py --step 2  # ODS â†’ DWD æ•°æ®æ¸…æ´—
python main.py --step 3  # DWD â†’ ADS ç‰¹å¾å·¥ç¨‹
python main.py --step 4  # ADS â†’ MySQL å¯¼å‡º
```

### æ–¹å¼äºŒï¼šæ‰‹åŠ¨åˆ†æ­¥æ‰§è¡Œ

#### æ­¥éª¤0: æ•°æ®é‡‡é›†ï¼ˆå¯é€‰ï¼‰

```bash
cd Spider_New

# æ–¹å¼1: ä½¿ç”¨Scrapyå‘½ä»¤
scrapy crawl qimao

# æ–¹å¼2: ä½¿ç”¨å¯åŠ¨è„šæœ¬
python run_scrapy.py
```

**é‡‡é›†èŒƒå›´**:
- æ—¶é—´è·¨åº¦: 2023å¹´10æœˆ - 2025å¹´10æœˆï¼ˆ24ä¸ªæœˆï¼‰
- æ¦œå•ç±»å‹: å¤§çƒ­æ¦œã€æ–°ä¹¦æ¦œã€å®Œç»“æ¦œã€æ”¶è—æ¦œã€æ›´æ–°æ¦œ
- åˆ†ç±»è¦†ç›–: ç”·é¢‘/å¥³é¢‘ Ã— 20+ç»†åˆ†åˆ†ç±»
- æ•°æ®é‡çº§: é¢„è®¡10ä¸‡+æ¡æ¦œå•è®°å½•

#### æ­¥éª¤1: MySQL â†’ Hive ODSå±‚

```bash
python Spark_MySQL_to_Hive.py
```

**æ‰§è¡Œå†…å®¹**:
- ä»MySQLè¯»å– `Seven_Cats_Novel_Data` è¡¨
- å…¨é‡å†™å…¥Hive `ods_novel_data` è¡¨
- æ”¯æŒè¦†ç›–æ¨¡å¼ï¼ˆoverwriteï¼‰å’Œè¿½åŠ æ¨¡å¼ï¼ˆappendï¼‰

**æ‰§è¡Œæ—¶é•¿**: çº¦1-5åˆ†é’Ÿï¼ˆå–å†³äºæ•°æ®é‡ï¼‰

#### æ­¥éª¤2: ODS â†’ DWDå±‚æ•°æ®æ¸…æ´—

```bash
python Spark_Data_processing.py
```

**æ‰§è¡Œå†…å®¹**:
1. è¯»å–ODSå±‚æ•°æ®
2. åˆ é™¤å…¨ç©ºåˆ—å’Œå…¨ç©ºè¡Œ
3. ç¼ºå¤±å€¼å¡«å……ï¼ˆæ•°å€¼å­—æ®µç”¨å‡å€¼ï¼‰
4. å¼‚å¸¸å€¼å¤„ç†ï¼ˆ3å€IQRæ³•åˆ™ï¼‰
5. æ•°å€¼åŒ–è½¬æ¢ï¼ˆpopularityã€read_countã€scoreã€words_numï¼‰
6. å†™å…¥DWDå±‚ `dwd_novel_data` è¡¨

**æ‰§è¡Œæ—¶é•¿**: çº¦2-10åˆ†é’Ÿ

#### æ­¥éª¤3: DWD â†’ ADSå±‚ç‰¹å¾å·¥ç¨‹

```bash
python Spark_dwd_to_ads.py
```

**æ‰§è¡Œå†…å®¹**:
- ç”Ÿæˆ8å¼ ADSç‰¹å¾è¡¨ï¼ˆè§ä¸Šæ–‡"å››å¤§åˆ†æç»´åº¦"ï¼‰
- æ¯å¼ è¡¨ç‹¬ç«‹è®¡ç®—ï¼Œäº’ä¸å¹²æ‰°
- æ”¯æŒå•è¡¨è°ƒè¯•å’Œå…¨é‡ç”Ÿæˆ

**æ‰§è¡Œæ—¶é•¿**: çº¦5-20åˆ†é’Ÿ

**è¾“å‡ºè¡¨åˆ—è¡¨**:
```
âœ“ ads_platform_heat
âœ“ ads_platform_ranking_trend
âœ“ ads_author_reason
âœ“ ads_author_attenuation_effect
âœ“ ads_user_layered_recommendation
âœ“ ads_user_avoid_pitfalls
âœ“ ads_capital_ltv
âœ“ ads_capital_future_purchasing_power
```

#### æ­¥éª¤4: Hive ADS â†’ MySQLå¯¼å‡º

```bash
python Sqoop_hive_to_MySQL.py
```

**æ‰§è¡Œå†…å®¹**:
- å°†8å¼ ADSè¡¨ä»Hiveå¯¼å‡ºåˆ°MySQL
- ä½¿ç”¨Spark JDBCé«˜æ€§èƒ½å†™å…¥
- æ”¯æŒè¦†ç›–æ¨¡å¼ï¼Œç¡®ä¿æ•°æ®æœ€æ–°

**æ‰§è¡Œæ—¶é•¿**: çº¦2-10åˆ†é’Ÿ

---

## ğŸ“Š æ•°æ®æŸ¥è¯¢ç¤ºä¾‹

### 1. æŸ¥è¯¢ä»Šæ—¥çƒ­åº¦é£™å‡çš„ä½œå“

```sql
SELECT 
    book_id,
    title,
    category1_name,
    popularity_diff AS æ—¥å¢é‡,
    popularity_acceleration AS åŠ é€Ÿåº¦,
    rank_date AS æ—¥æœŸ
FROM QimaoScraper_Feature_Data.ads_platform_heat
WHERE heat_surge_flag = 1 
  AND rank_date = CURRENT_DATE
ORDER BY popularity_acceleration DESC
LIMIT 10;
```

### 2. è¯†åˆ«"å¾·ä¸é…ä½"çš„æ¨èä½

```sql
SELECT 
    book_id,
    title,
    rank_name AS æ¦œå•åç§°,
    ranking_conversion_rate AS è½¬åŒ–ç‡,
    recommend_weight AS æ¨èæƒé‡
FROM QimaoScraper_Feature_Data.ads_platform_ranking_trend
WHERE is_unworthy = 1  -- å¾·ä¸é…ä½
  AND ranking_conversion_rate < 0.3  -- è½¬åŒ–ç‡ä½äº30%
ORDER BY recommend_weight ASC
LIMIT 20;
```

### 3. æŒ–æ˜å°ä¼—çˆ†æ¬¾ä½œå“

```sql
SELECT 
    book_id,
    title,
    category1_name AS åˆ†ç±»,
    gender_type AS æ€§åˆ«å‘,
    relative_heat AS ç›¸å¯¹çƒ­åº¦,
    numeric_score AS è¯„åˆ†,
    niche_recommendation_score AS æ¨èåˆ†æ•°
FROM QimaoScraper_Feature_Data.ads_user_layered_recommendation
WHERE is_niche_hit = 1  -- å°ä¼—çˆ†æ¬¾æ ‡è¯†
  AND gender_type = 'male'  -- ç”·é¢‘
  AND category1_name = 'ç§‘å¹»'
ORDER BY niche_recommendation_score DESC
LIMIT 10;
```

### 4. IPæŠ•èµ„ä»·å€¼è¯„ä¼°

```sql
SELECT 
    book_id,
    title,
    author,
    ltv_score AS LTVåˆ†æ•°,
    ip_value_level AS IPç­‰çº§,
    adaptation_suggestion AS æ”¹ç¼–å»ºè®®,
    total_heat_integral AS çƒ­åº¦ç§¯åˆ†,
    lifecycle_days AS ç”Ÿå‘½å‘¨æœŸå¤©æ•°
FROM QimaoScraper_Feature_Data.ads_capital_ltv
WHERE ip_value_level IN ('S', 'A')  -- é«˜ä»·å€¼IP
  AND adaptation_suggestion LIKE '%é•¿å‰§%'  -- é€‚åˆé•¿å‰§æ”¹ç¼–
ORDER BY ltv_score DESC
LIMIT 20;
```

### 5. è¯†åˆ«é«˜ARPUæ ¸å¿ƒç²‰ä¸ä½œå“

```sql
SELECT 
    book_id,
    title,
    avg_arpu AS å¹³å‡ARPU,
    fan_value_score AS ç²‰ä¸ä»·å€¼åˆ†æ•°,
    investment_value_level AS æŠ•èµ„ä»·å€¼ç­‰çº§,
    investment_recommendation AS æŠ•èµ„å»ºè®®
FROM QimaoScraper_Feature_Data.ads_capital_future_purchasing_power
WHERE investment_value_level = 'ä¼˜è´¨'
  AND avg_arpu > 50  -- ARPU > 50
ORDER BY fan_value_score DESC
LIMIT 15;
```

---

## ğŸ”§ é«˜çº§åŠŸèƒ½

### è‡ªå®šä¹‰ç‰¹å¾å¼€å‘

å¦‚éœ€æ–°å¢ç‰¹å¾è¡¨ï¼Œä¿®æ”¹ [Spark_dwd_to_ads.py](Data_visualisation/Spark_dwd_to_ads.py)ï¼š

```python
def create_custom_feature(self, df):
    """
    è‡ªå®šä¹‰ç‰¹å¾è¡¨ç”Ÿæˆ
    :param df: DWDå±‚DataFrame
    :return: ç‰¹å¾DataFrame
    """
    from pyspark.sql.functions import col, when, avg
    
    # ç¤ºä¾‹ï¼šè®¡ç®—ä½œå“çš„ROIæŒ‡æ ‡
    custom_df = df.select(
        "book_id", "title", "author",
        col("numeric_popularity").alias("popularity"),
        col("numeric_read_count").alias("read_count"),
        col("numeric_score").alias("score")
    ).withColumn(
        "roi_score",
        when(col("read_count") > 0, 
             col("popularity") / col("read_count")
        ).otherwise(0)
    )
    
    return custom_df

# åœ¨run()æ–¹æ³•ä¸­è°ƒç”¨
def run(self):
    # ... ç°æœ‰ä»£ç  ...
    
    # æ–°å¢è‡ªå®šä¹‰ç‰¹å¾è¡¨
    custom_feature = self.create_custom_feature(dwd_df)
    self.save_to_hive(custom_feature, "ads_custom_roi")
```

### å¢é‡æ›´æ–°æ”¯æŒ

ä¿®æ”¹ [config.py](Data_visualisation/config.py) ä¸­çš„æ›´æ–°æ¨¡å¼ï¼š

```python
# å…¨é‡è¦†ç›–æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰
WAREHOUSE_UPDATE_MODE = "overwrite"

# å¢é‡è¿½åŠ æ¨¡å¼
WAREHOUSE_UPDATE_MODE = "append"
```

### æ€§èƒ½è°ƒä¼˜

```python
# è°ƒæ•´Sparkåˆ†åŒºæ•°ï¼ˆconfig.pyï¼‰
SPARK_CONFIG = {
    "shuffle_partitions": 20,  # æ ¹æ®æ•°æ®é‡è°ƒæ•´ï¼ˆé»˜è®¤10ï¼‰
    "driver_memory": "4g",     # å¢åŠ é©±åŠ¨å†…å­˜
    "executor_memory": "4g"    # å¢åŠ æ‰§è¡Œå™¨å†…å­˜
}
```

---

## ğŸ“ˆ ç›‘æ§ä¸æ—¥å¿—

### æ—¥å¿—æŸ¥çœ‹

æ‰€æœ‰è„šæœ¬éƒ½è¾“å‡ºè¯¦ç»†æ—¥å¿—ï¼š

```bash
# æŸ¥çœ‹å®æ—¶æ—¥å¿—
tail -f nohup.out

# æœç´¢é”™è¯¯æ—¥å¿—
grep "ERROR" nohup.out
```

### æ—¥å¿—çº§åˆ«

```python
# ä¿®æ”¹æ—¥å¿—çº§åˆ«ï¼ˆåœ¨å„è„šæœ¬é¡¶éƒ¨ï¼‰
logging.basicConfig(
    level=logging.INFO,  # å¯æ”¹ä¸ºDEBUGæŸ¥çœ‹æ›´å¤šç»†èŠ‚
    format='%(asctime)s - %(levelname)s - %(message)s'
)
```

### æ‰§è¡Œç›‘æ§

```bash
# ç›‘æ§Sparkä»»åŠ¡
# è®¿é—® http://localhost:4040 æŸ¥çœ‹Spark Web UI

# ç›‘æ§Hiveä»»åŠ¡
beeline -u jdbc:hive2://localhost:10000
> SHOW TABLES;
> SELECT COUNT(*) FROM ads_platform_heat;
```

---

## â“ å¸¸è§é—®é¢˜

### Q1: Hiveè¿æ¥å¤±è´¥ï¼Ÿ

**ç°è±¡**: `Could not connect to meta store using thrift`

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ£€æŸ¥Metastoreæ˜¯å¦å¯åŠ¨
jps | grep RunJar

# å¯åŠ¨Metastore
nohup hive --service metastore &

# éªŒè¯è¿æ¥
beeline -u jdbc:hive2://localhost:10000
```

### Q2: Sparkå†…å­˜ä¸è¶³ï¼Ÿ

**ç°è±¡**: `java.lang.OutOfMemoryError`

**è§£å†³æ–¹æ¡ˆ**:
```python
# ä¿®æ”¹Sparké…ç½®ï¼ˆåœ¨å„è„šæœ¬ä¸­ï¼‰
spark = SparkSession.builder \
    .config("spark.driver.memory", "4g") \
    .config("spark.executor.memory", "4g") \
    .config("spark.sql.shuffle.partitions", "20") \
    .getOrCreate()
```

### Q3: MySQLè¿æ¥è¶…æ—¶ï¼Ÿ

**ç°è±¡**: `pymysql.err.OperationalError: (2003, "Can't connect to MySQL server")`

**è§£å†³æ–¹æ¡ˆ**:
```python
# å¢åŠ è¿æ¥è¶…æ—¶æ—¶é—´ï¼ˆconfig.pyï¼‰
MYSQL_CONFIG = {
    "host": "your_host",
    "connect_timeout": 60,  # å¢åŠ è¶…æ—¶æ—¶é—´
    # ...å…¶ä»–é…ç½®
}
```

### Q4: æ•°å€¼è½¬æ¢å‡ºé”™ï¼Ÿ

**ç°è±¡**: `ValueError: could not convert string to float`

**è§£å†³æ–¹æ¡ˆ**:
```python
# æ£€æŸ¥Spark_Data_processing.pyä¸­çš„æ•°å€¼åŒ–å‡½æ•°
# ç¡®ä¿æ­£åˆ™è¡¨è¾¾å¼èƒ½åŒ¹é…æ‰€æœ‰æ ¼å¼
def convert_to_numeric(value_str):
    if value_str is None or value_str == "":
        return 0.0
    # æ·»åŠ æ›´å¤šæ ¼å¼æ”¯æŒ
    if "äº¿" in value_str:
        return float(value_str.replace("äº¿", "")) * 100000000
    # ...
```

### Q5: ADSè¡¨æ•°æ®ä¸º0ï¼Ÿ

**ç°è±¡**: `ads_user_avoid_pitfalls è¡¨åˆ›å»ºå®Œæˆï¼Œå…± 0 æ¡æ•°æ®`

**æ’æŸ¥æ­¥éª¤**:
```sql
-- 1. æ£€æŸ¥DWDå±‚æ˜¯å¦æœ‰æ•°æ®
SELECT COUNT(*) FROM hive_QimaoScraper.dwd_novel_data;

-- 2. æ£€æŸ¥å­—æ®µå€¼åˆ†å¸ƒ
SELECT 
    COUNT(*) AS æ€»æ•°,
    AVG(numeric_popularity) AS å¹³å‡çƒ­åº¦,
    AVG(numeric_score) AS å¹³å‡è¯„åˆ†
FROM hive_QimaoScraper.dwd_novel_data;

-- 3. æ£€æŸ¥è¿‡æ»¤æ¡ä»¶æ˜¯å¦è¿‡ä¸¥
-- ä¿®æ”¹Spark_dwd_to_ads.pyä¸­çš„è¿‡æ»¤é€»è¾‘
```

---

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿è´¡çŒ®ä»£ç å’Œå»ºè®®ï¼

### è´¡çŒ®æ–¹å¼

1. Forkæœ¬é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æäº¤Pull Request

### å¼€å‘è§„èŒƒ

- ä»£ç é£æ ¼: éµå¾ªPEP 8
- æ³¨é‡Šè¦æ±‚: å…³é”®å‡½æ•°å¿…é¡»æœ‰æ–‡æ¡£å­—ç¬¦ä¸²
- æµ‹è¯•è¦æ±‚: æ–°åŠŸèƒ½éœ€åŒ…å«å•å…ƒæµ‹è¯•

---

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®ä»…ä¾›**å­¦ä¹ å’Œç ”ç©¶ä½¿ç”¨**ï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ã€‚

---

## ğŸ“® è”ç³»æ–¹å¼

- **é¡¹ç›®ç»´æŠ¤è€…**: ç¨‹åºå‘˜Eighteen
- **é—®é¢˜åé¦ˆ**: è¯·é€šè¿‡Issuesæäº¤
- **é‚®ç®±**: 3273495516@qq.com & eighteenthstuai@gmail.com

---

## ğŸ™ è‡´è°¢

æ„Ÿè°¢ä»¥ä¸‹å¼€æºé¡¹ç›®ï¼š
- [Apache Spark](https://spark.apache.org/)
- [Apache Hive](https://hive.apache.org/)
- [Scrapy](https://scrapy.org/)
- [MySQL](https://www.mysql.com/)

---

<p align="center">
  <b>â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸ªStaræ”¯æŒä¸€ä¸‹ï¼â­</b>
</p>

- ä½œè€…: ç¨‹åºå‘˜Eighteen
- åˆ›å»ºæ—¥æœŸ: 2025-12-16
